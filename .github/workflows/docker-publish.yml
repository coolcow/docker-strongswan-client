name: Build and Publish

on:
  push:
    branches: [ 'main' ]
    tags: [ 'v*.*.*' ]
  pull_request:
    branches: [ 'main' ]

jobs:
  call-reusable-workflow:
    permissions:
      contents: read
      packages: write
      id-token: write
    uses: coolcow/workflows/.github/workflows/build-and-publish.yml@v1.1.2
    with:
      image_name: 'strongswan-client'
      build_context: 'build'
      dockerfile_path: 'build/Dockerfile'
      test_dockerfile_path: 'build/Dockerfile.test'
    secrets: inherit
